function Value(c){function u(a){a&&(typeof a==="object"&&v(a),typeof a==="string"&&a in w&&v(w[a]))}function v(a){l(a.separator)&&(m=a.separator);l(a.symbol)&&(n=a.symbol);l(a.position)&&a.position.length&&(q=a.position);l(a.nill)&&(j=a.nill);typeof a.format_thousands==="boolean"&&(r=a.format_thousands);switch(q){case "before":x=n+m;break;default:y=m+n}}function e(a){return!isNaN(parseFloat(a))}function l(a){return typeof a==="string"}if(!(this instanceof Value))return new Value(c);var b=this,c=c||
{},f=e(c.value)&&c.value||0,g=e(c.min)&&c.min||(f>=0?0:f),h=e(c.max)&&c.max||Number.MAX_VALUE,i=e(c.nudge)&&Math.abs(c.nudge)||1,o=e(c.plus_nudge)&&Math.abs(c.plus_nudge)||i,p=e(c.minus_nudge)&&-1*Math.abs(c.minus_nudge)||-1*Math.abs(i),s=typeof c.frozen==="boolean"?c.frozen:!1,m="",n="",q="after",j="",r=!1,x="",y="",t=[],z=0,w={quantity:{symbol:"",format_thousands:!0},money:{symbol:"$",position:"before",format_thousands:!0},percent:{symbol:"%"}};u(c.format);b.format=function(a){return a?(u(a),b):
{separator:m,symbol:n,position:q,nill:j,format_thousands:r}};b.setNudge=function(a){return e(a)?(i=Math.abs(a),o=Math.abs(i),p=-1*Math.abs(i),b):i};b.plusNudge=function(a){return e(a)?(o=Math.abs(a),b):o};b.minusNudge=function(a){return e(a)?(p=-1*Math.abs(a),b):p};b.nudge=function(a,k){b.set(f+a,k);return b};b.plus=function(a,k){var d=e(a)?a:o;b.set(f+d,typeof a==="function"?a:k);return b};b.minus=function(a,k){var d=e(a)?a:p;b.set(f+d,typeof a==="function"?a:k);return b};b.get=function(){var a=
f,b;if(r){var d=Math.floor(a);b=a-d;var c=d+"",e=c.length%3||3,d=c.substr(0,e),c=c.substr(e),c=c.replace(/(\d{3})/g,",$1");b&&(c+=(b+"").substr(1));b=d+c}else b=a+"";b=x+b+y;a===0&&j&&(b=j);return b};b.set=function(a,c){if(a!==""){if(e(a))var d=parseFloat(a);else d=a,d+="",d=d===j?0:d.replace(/\D/gi,""),d=parseFloat(d);if(!isNaN(d)&&d>=g&&d<=h&&d!==f&&(z=d-f,s||(f=d),(c&&c.call(b,b))!==!1))for(var d=0,i=t.length;d<i;d++)t[d].call(b,b)}return b};this.value=function(){return f};this.max=function(a){return e(a)?
(h=a,f>=g&&f<=h||b.set(h),g>h&&b.min(h),b):h};this.min=function(a){return e(a)?(g=a,f>=g&&f<=h||b.set(g),g>h&&b.max(g),b):g};this.delta=function(){return z};this.freeze=function(){s=!0;return b};this.defrost=function(){s=!1;return b};this.subscribe=function(a){t.push(a);return b};this.derive=function(){for(var a=Array.prototype.slice.apply(arguments,[0,arguments.length-1]),c=arguments[arguments.length-1],d=function(){b.set(c.apply(b,a))},e=0,f=arguments.length-1;e<f;e++){var g=arguments[e];if(!(g instanceof
Value))return!1;g.subscribe(d)}d();return b};this.toString=this.get;this.valueOf=this.value};